---
title: "Pandemic Preparedness and COVID-19"
author: "Amal Surmawala, Nour Abdelmoneim & Rishit Saxena"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r load-data-and-packages}
covid_data <- read.csv("https://wzb-ipi.github.io/corona/df_full.csv"
)

library(tidyverse)
library(glue)
library(lubridate)
library(rms)
library(dplyr)
library(ggplot2)

```

#Introduction

Taking the world by storm in late 2019, the coronavirus pandemic has had (and continues to have) significant social and economic impacts on countries around the world. In the midst of trying to cope with this new public health crisis, data scientists and statisticians have developed models and ran analyses to try and predict which policies will have an effect on reducing the risks of the pandemic. It is also worth analysing the effect of specific variables on nations’ ability to deal with the virus, something which will hopefully lead to a better understanding of what courses of action can be taken to reduce the number of cases and deaths resulting from COVID-19. 

Our intention was to analyse the pandemic preparedness variable in the corona dataset from this GitHub file (https://wzb-ipi.github.io/corona/df_full.csv). The pandemic preparedness variable in the corona dataset we used is taken from the Global Health Security Index (GHSI). The GHSI takes into account factors such as the ability of countries to prevent, detect and respond rapidly to an epidemic. It also considers the capacity of the healthcare system within the country to deal with the strains of pandemics like COVID-19, as well as the country’s commitment to international norms and how ‘risky’ an environment each country poses to the spread of pandemics. We hypothesized that the higher the pandemic preparedness score of the country in question, the lower the number of cumulative deaths per million in the nation. Upon visualizing the data, however, we were faced with unexpected results. 
```{r plot-pan-prep}
covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million)) +
  geom_point() +
  stat_smooth(method = "lm") + 
  labs(title = "Relationship between Pandemic Preparedness and Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million") +
  theme_minimal() +
   theme(title = element_text(size = 7)) 
```

Contrary to our expectations, the visualization showed that as the pandemic preparedness scores of the nations in the dataset increased, so did the number of cumulative deaths per million. Noting this trend, and acknowledging its contradiction of our initial hypothesis, we decided to adjust our research question and approach to deal with the results we had seen. Thus, our final research question is: why does the number of cumulative deaths per million increase as the pandemic preparedness score rises? How can we explain the fact that countries with a high pandemic preparedness scores also had higher numbers of cumulative deaths per million? 

This paper will attempt to answer these questions and explain the trends found in our preliminary research by considering confounding variables such as GDP per capita, air travel, age and mean mobility index. 

#Theory

The GHSI incorporates a variety of variables to measure the pandemic preparedness of the countries it scores, including “social, political, technical and environmental determinants of health security” (Ravi et al. 3). The use of publicly available data and evidence to account for scores, in addition, lends it a level of transparency and reliability (Ravi et al. 5). Even so, criticism has been levelled at the index for excluding variables of importance and “inadequately weighting others that could more accurately capture the likely response of countries in such an emergency as COVID-19” (Haider et al. 7). Such criticism suggests that it is entirely possible that the GHSI does not account for some variables that may specifically affect the cumulative deaths per million as a result of COVID-19. This paper attempts to identify, therefore, some of the confounding variables that may explain the counter-intuitive relationship seen in the plot above between pandemic preparedness and cumulative deaths per million. 

In their analysis of the GHSI, Boyd et al. noted that one factor associated with higher GHSI scores was GDP per capita (6). This relationship can be seen from the figure below, which demonstrates that countries with higher GDPs per capita tend to have higher pandemic preparedness scores. 

```{r plot-pan-gdp}
covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million, color = gdp_pc)) +
  scale_color_viridis_c() +
  geom_point() +
  stat_smooth(method = "lm") + 
  labs(title = " Pandemic Preparedness and Cumulative Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million", 
       color = "GDP per Capita") +
  theme_minimal()+
  theme(title = element_text(size = 7))
```

The association between wealth and the GHSI score suggested to us a possible confounding variable: air travel. Scholars have argued that demand for international air travel is determined, at least partially, by the wealth of consumers. Analysis conducted by the Centre for Aviation concludes that the wealth of a country and air travel are closely correlated - the number of airline seats per capita tends to be higher for countries with higher GDPs per capita (“Air Travel Rises with a Country’s Wealth”). 

```{r plot-gdp-air-travel}
covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = gdp_pc, y = air_travel)) +
  geom_point() +
  stat_smooth(method = "lm") +
  labs(title = "Relationship between GDP per Capita and Air Travel",
       y = "Air Travel", 
       x = "GDP per Capita")
```

As the plot shows, and the analysis by the Centre for Aviation indicates, the level of air travel rises as the GDP per capita of a country increases. Alperovich and Machnes’ case study of the relationship between consumer wealth and demand for international air travel in Israel finds support for the view that demand for air travel rises as consumer wealth does (169). Wealthier countries, in other words, tend to have greater levels of air travel because consumers have enough disposable income to afford flights both domestically and internationally. Given the relationship between wealth and air travel, as well as that between GDP per capita and GHSI pandemic preparedness scores, we theorize that air travel is a confounding variable that could explain the relationship we noticed upon initially visualising pandemic preparedness and cumulative deaths per million. In other words, countries with higher pandemic preparedness scores also tend to be wealthier, which means that they are more likely to have higher levels of air travel. Due to the fact that the level of air travel is greater in these nations, transmission of the virus across boundaries is made easier, leading to a higher number of COVID-19 cases and overall coronavirus deaths in wealthier countries. 

Another possible confounding variable is age. Wealthier nations tend to have higher proportions of people aged above 65 (Tirrito qtd in Crampton 4). The CDC warns that the elderly are at greater risk of requiring hospitalization for and dying from COVID-19 (“Older Adults and COVID-19”). Given that higher pandemic preparedness scores tend to be granted to wealthier nations, and that COVID-19 is reported to pose a greater risk to older adults, we theorized that the nations with higher pandemic preparedness scores also had ageing populations that were more at susceptible to the virus, and therefore saw higher cumulative deaths per million. 

```{r age-and-air-travel}
ggplot(covid_data, mapping = aes(x = share_older, y = air_travel)) +
  geom_point() +
  stat_smooth(method = "lm") +
  labs(title = "Relationship between Air Travel and Age",
       x = "Share of Population Over 65", 
       y = "Air Travel")
```

The plot above shows that the level of air travel increases as the share of the population above 65 rises. Population ageing has led to an increase in interest by researchers and economists on the travel behaviour of seniors and the market for older adults in the tourism industry (Nielsen 111). One theory is that older persons have more free time for leisure and travel because of fewer obligations after retirement and family responsibilities as their children may have already left home, which may explain the positive correlation shown above between air travel and the share of the population above 65, though admittedly they may face travel constraints in the form of low income or health issues (Nielsen 115). 

The final confounding variable we chose to consider for our paper is mean mobility index. Li et al. report in their article “Association Between Population Mobility Reductions and New COVID-19 Diagnoses in the United States Along the Urban–Rural Gradient” that reductions in population mobility may act to constrain the growth rate of COVID-19 cases. As such, we decided to consider the mean mobility index as a potential confounding variable. We theorize that countries with a higher mean mobility value would also have a higher number of cumulative deaths per million, as greater mobility of populations may lead to a more rapid spread of the virus and so a rise in the overall number of cases and deaths. 

Thus, our hypothesis is that once we account for air travel, age, and mean mobility, we will see a change in the relationship between pandemic preparedness and cumulative deaths per million as seen in the original visualization. More specifically, we hypothesize that the correlation between pandemic preparedness and higher cumulative deaths per million will decrease. 

#Data

All the data we used to test our hypothesis comes from this GitHub file (https://wzb-ipi.github.io/corona/df_full.csv) from the paper “Political and Social Correlates of Covid-19 Mortality”, as introduced above. The data on GDP per capita is taken from the World Bank. The air travel variable measures the air passengers carried in both domestic and international aircrafts. The source for the data is also the World Bank. The age variable we chose is the share_older column of the corona dataset (similarly taken from World Bank) that estimates the share of the population over 65. We use the mobility data provided by downloaded from the Google database that our coronavirus dataset contained. The mobility index shows how visits and lengths of stay at different places (e.g. grocery stores) changes according to a baseline.

##Limitations

The first limitation we encountered with our data is the lack of reporting of COVID-19 deaths. The quality and integrity of reporting COVID-19 deaths varies between countries, and since we are doing a worldwide analysis and comparing different countries, that variation had a considerable effect on our data and, ultimately, results. For example, England only counted deaths in hospitals (excluding care home deaths) until April 29th, whereas France and Belgium included care-home deaths from the beginning [SOURCE].

Another limitation was the lack of a standardized system to attribute one’s cause of death to COVID. Attributing the cause of death to COVID is a complicated process between countries; some countries only count a death as a COVID death if the person had a positive COVID test result, whereas others rely on doctors’ opinions [SOURCE]. Moreover, many COVID deaths particularly early on in the pandemic were attributed to other causes such as pneumonia. For those reasons, the actual number of COVID deaths is predicted to be much higher than the number of reported deaths that we had

Testing is not as accessible in some countries than it is for others. As mentioned earlier, in many countries, in order for a death to be considered a COVID death, the person would need to have had a positive COVID test result within a specific time range. That means that in countries where testing is not as accessible, reported COVID deaths might be much lower than the actual number of COVID related deaths.




```{r plot-air-travel}

covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million, color = air_travel)) +
  scale_color_viridis_c() +
  geom_point() +
  stat_smooth(method = "lm") + 
  labs(title = "Pandemic Preparedness and Cumulative Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million", 
       color = "Air Travel") +
  theme_minimal()+
  theme(title = element_text(size = 7))

covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = air_travel, y = deaths_cum_per_million)) +
  geom_point() +
  stat_smooth(method = "lm") +
  labs(title = "Air Travel and Cumulative Deaths per Million",
       x = "Air Travel", 
       y = "Cumulative Deaths per Million") +
  theme_minimal()
  
```

```{r plot-share-older}
covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million, color = share_older)) +
  scale_color_viridis_c() +
  geom_point() +
  stat_smooth(method = "lm") + 
  labs(title = "Pandemic Preparedness and Cumulative Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million", 
       color = "Population 65+") +
  theme_minimal() +
   theme(title = element_text(size = 7)) 

covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = share_older, y = deaths_cum_per_million)) +
  geom_point() +
  stat_smooth(method = "lm") +
  labs(title = "Older Populations and Cumulative Deaths per Million",
       x = "Share of Population Over 65", 
       y = "Cumulative Deaths per Million") +
  theme_minimal()

```



```{r plot-combined}
covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million, color = gdp_pc, alpha = air_travel)) +
  scale_color_viridis_c() +
  geom_point(size = 3) +
  stat_smooth(method = "lm") + 
  labs(title = "Relationship between Pandemic Preparedness and Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million", 
       color = "GDP per Capita", 
       alpha = "Air Travel") +
  theme_minimal()
```



