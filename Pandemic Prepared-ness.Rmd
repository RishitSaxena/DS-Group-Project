---
title: "Pandemic Prepared-ness and Covid-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r load-data}
covid_data <- read.csv("https://wzb-ipi.github.io/corona/df_full.csv"
)

covid_data
```
```{r libraries}
library(tidyverse)
library(glue)
library(lubridate)
```
```{r modify-dates}
covid_data <- covid_data %>%
  mutate(
    dates = ymd(glue("{year} {month} {day}"))
  )

covid_data %>%
```

```{r plot-preparedness}
ggplot(covid_data, mapping = aes(x = dates, y = deaths_cum_per_million, group = country, color = pandemic_prep)) +
  scale_color_viridis_c() +
  geom_line()

ggplot(covid_data, mapping = aes(x = pandemic_prep, y = cases)) +
  geom_point() +
  geom_smooth()
```
```{r model-preparedness}
pandemic_prep_model <- lm(cases ~ pandemic_prep, data = covid_data)

summary(pandemic_prep_model)

```

```{r mutate-pan-prep}
covid_data %>%
  filter(pandemic_prep > 60) %>%
ggplot(covid_data, mapping = aes(x = dates, y = deaths, group = country, color = pandemic_prep)) +
  scale_color_viridis_c() +
  geom_line()

covid_data %>%
  filter(pandemic_prep > 60) %>%
ggplot(covid_data, mapping = aes(x = dates, y = deaths, group = country, color = C5_Close.public.transport)) +
  scale_color_viridis_c() +
  geom_line()

covid_data %>%
  filter(pandemic_prep > 60) %>%
ggplot(covid_data, mapping = aes(x = dates, y = deaths, group = country, color = C6_Stay.at.home.requirements)) +
  scale_color_viridis_c() +
  geom_line()

covid_data %>%
  filter(pandemic_prep > 60) %>%
ggplot(covid_data, mapping = aes(x = dates, y = deaths, group = country, color = C7_Restrictions.on.internal.movement)) +
  scale_color_viridis_c() +
  geom_line()

covid_data %>%
  filter(pandemic_prep > 60) %>%
ggplot(covid_data, mapping = aes(x = dates, y = deaths, group = country, color = C8_International.travel.controls)) +
  scale_color_viridis_c() +
  geom_line()
```

Why is there so much variation in the cumulative deaths per million between countries with relatively high levels of pandemic preparedness? 
