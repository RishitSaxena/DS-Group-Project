---
title: "Pandemic Prepared-ness and Covid-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r load-data}
covid_data <- read.csv("https://wzb-ipi.github.io/corona/df_full.csv"
)

covid_data
```
```{r libraries}
library(tidyverse)
library(glue)
library(lubridate)
library(rms)
```

```{r modify-dates}
covid_data <- covid_data %>%
  mutate(
    dates = ymd(glue("{year} {month} {day}"))
  )
```
```{r plot-pan-prep}
covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million)) +
  geom_point() +
  stat_smooth(method = "lm") + 
  labs(title = "Relationship between Pandemic Preparedness and Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million")

covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million, color = gdp_pc)) +
  scale_color_viridis_c() +
  geom_point() +
  stat_smooth(method = "lm") + 
  labs(title = "Relationship between Pandemic Preparedness and Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million", 
       color = "GDP per Capita")

covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million, color = air_travel)) +
  scale_color_viridis_c() +
  geom_point() +
  stat_smooth(method = "lm") + 
  labs(title = "Relationship between Pandemic Preparedness and Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million", 
       color = "Air Travel")
```
```{r plot-gdp-air-travel}
covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = gdp_pc, y = air_travel)) +
  geom_point() +
  stat_smooth(method = "lm") +
  labs(title = "Relationship between GDP per Capita and Air Travel",
       y = "Air Travel", 
       x = "GDP per Capita")
```

```{r plot-combined}
covid_data %>%
  filter(date == "2020-11-30") %>%
  ggplot(covid_data, mapping = aes(x = pandemic_prep, y = deaths_cum_per_million, color = gdp_pc, alpha = air_travel)) +
  scale_color_viridis_c() +
  geom_point(size = 3) +
  stat_smooth(method = "lm") + 
  labs(title = "Relationship between Pandemic Preparedness and Deaths Per Million", 
       x = "Pandemic Preparedness", 
       y = "Cumulative Deaths per Million", 
       color = "GDP per Capita", 
       alpha = "Air Travel") +
  theme_minimal()
```

```{r organise-map-data}
install.packages("maps")
library(maps)
world_map <- map("world")

ggplot(world_map, mapping = aes(x = long, y = lat, group = group)) +
  geom_polygon(fill = "gray") +
  theme_minimal()
```
```{r pandemic-map}
pandemic_map <- left_join(covid_data, world_map, 
                          by = c("country" = "region"))

glimpse(pandemic_map)

```

